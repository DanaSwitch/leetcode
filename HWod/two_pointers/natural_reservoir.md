# åä¸ºodåŒæœºä½Cå· 12-2 å¤©ç„¶è“„æ°´æ± 

## ä¸€ã€é¢˜ç›®æ¦‚è¿°

å…¬å…ƒ 2919 å¹´ï¼Œäººç±»åœ¨ X æ˜Ÿå‘ç°äº†ä¸€ç‰‡è¿ç»µèµ·ä¼çš„å±±è„‰ï¼Œå¸Œæœ›åœ¨å…¶ä¸­é€‰æ‹©ä¸¤å¤„ä½œä¸ºæ°´åº“è¾¹ç•Œï¼ˆæŒ¡æ¿ï¼‰ï¼Œåœ¨å…¶é—´è“„æ°´ï¼Œä½¿å¾—**è“„æ°´é‡æœ€å¤§**ã€‚

### é¢˜ç›®è¦æ±‚

- å±±è„‰ç”±æ­£æ•´æ•°æ•°ç»„ `s` è¡¨ç¤ºï¼Œ`s[i]` ä¸ºç¬¬ `i` å¤„çš„é«˜åº¦
- é€‰æ‹©ä¸¤ä¸ªä½ç½®ä½œä¸º**è¾¹ç•Œï¼ˆæŒ¡æ¿ï¼‰**
- è“„æ°´é«˜åº¦ç”±å·¦å³è¾¹ç•Œçš„æœ€å°å€¼å†³å®š
- è“„æ°´é‡éœ€è¦ **æ‰£é™¤å±±ä½“æœ¬èº«å ç”¨çš„ä½“ç§¯**
- è‹¥å­˜åœ¨å¤šä¸ªæœ€å¤§è“„æ°´é‡çš„æ–¹æ¡ˆï¼Œé€‰æ‹© **è¾¹ç•Œè·ç¦»æœ€è¿‘** çš„
- è‹¥æ— æ³•è“„æ°´ï¼Œè¾“å‡º `0`





## äºŒã€ä¸Leetcode T42çš„è”ç³»

### ç›¸åŒç‚¹

| é¡¹ç›®     | æœ¬é¢˜               | LC42               |
| -------- | ------------------ | ------------------ |
| åœ°å½¢å»ºæ¨¡ | ä¸€ç»´é«˜åº¦æ•°ç»„       | ä¸€ç»´é«˜åº¦æ•°ç»„       |
| æ ¸å¿ƒæ¦‚å¿µ | å·¦å³æœ€å¤§é«˜åº¦       | å·¦å³æœ€å¤§é«˜åº¦       |
| æ°´ä½å®šä¹‰ | `min(left, right)` | `min(left, right)` |

ä¸¤è€…éƒ½åŸºäº **â€œç¨³å®šæ°´ä½çº¿â€** çš„æ¦‚å¿µã€‚

------

### å…³é”®å·®å¼‚ï¼ˆå‡ºé¢˜å±‚é¢ï¼‰

| ç»´åº¦             | LeetCode 42  | æœ¬é¢˜           |
| ---------------- | ------------ | -------------- |
| ç›®æ ‡             | è®¡ç®—æ€»è“„æ°´é‡ | æ‰¾æœ€å¤§å•ä¸ªæ°´åº“ |
| è®¡ç®—æ–¹å¼         | æŒ‰ä½ç½®ç´¯åŠ    | æŒ‰åŒºé—´æ•´ä½“è®¡ç®— |
| æ˜¯å¦å…³å¿ƒè¾¹ç•Œ     | âŒ            | âœ…              |
| æ˜¯å¦è¦æ±‚æœ€è¿‘è¾¹ç•Œ | âŒ            | âœ…              |
| æ˜¯å¦è¾“å‡ºç»“æ„     | âŒ            | âœ…              |



### ä¸€å¥è¯â€œå‡ºé¢˜äººè§†è§’æ€»ç»“â€ï¼ˆéå¸¸åŠ åˆ†ï¼‰

> æœ¬é¢˜åœ¨æ¥é›¨æ°´æ¨¡å‹åŸºç¡€ä¸Šï¼Œè¿›ä¸€æ­¥è¦æ±‚è¯†åˆ«å¹¶æ¯”è¾ƒä¸åŒè“„æ°´ç»“æ„ï¼Œ
>  å› æ­¤éœ€è¦ä»æ°´ä½çº¿å‡ºå‘ï¼Œåå‘ç¡®å®šèƒ½å¤Ÿå½¢æˆæœ€å¤§è¿ç»­è“„æ°´åŒºé—´çš„è¾¹ç•Œã€‚



### æœ¬è´¨å·®å¼‚æ€»ç»“

- **LeetCode 42** æ˜¯ä¸€ä¸ª **å…¨å±€ç´¯åŠ é—®é¢˜**
- **æœ¬é¢˜** æ˜¯ä¸€ä¸ª **ç»“æ„é€‰æ‹©é—®é¢˜**

LeetCode 42 å¹¶ä¸å…³å¿ƒæ°´æ¥è‡ªå“ªä¸ªæ°´åº“ï¼›
 è€Œæœ¬é¢˜å¿…é¡»æ˜ç¡®ç»™å‡ºä¸€å¯¹è¾¹ç•Œï¼Œå¹¶åœ¨å¤šç§è“„æ°´ç»“æ„ä¸­è¿›è¡Œé€‰æ‹©ã€‚

------

## ä¸‰ã€é—®é¢˜å»ºæ¨¡ï¼ˆéå¸¸å…³é”®ï¼‰

è¿™é“é¢˜**è¡¨é¢ä¸Šæ˜¯â€œé€‰æ‹©è¾¹ç•Œâ€**ï¼Œä½†ä»åˆ¤é¢˜è§’åº¦çœ‹ï¼Œå…¶å®é™…é‡‡ç”¨çš„æ˜¯ä¸€ç§ï¼š

> **åŸºäºå…¨å±€æ°´ä½çº¿çš„è“„æ°´æ¨¡å‹**

è¿™ä¸ç»å…¸çš„ **LeetCode 42ï¼ˆæ¥é›¨æ°´ï¼‰** é—®é¢˜åœ¨å»ºæ¨¡ä¸Šé«˜åº¦ç›¸å…³ï¼Œä½†åˆæœ‰æœ¬è´¨å·®å¼‚ã€‚

------

## å››ã€æ ¸å¿ƒæ€è·¯ï¼šæ°´ä½çº¿ + è¿ç»­è“„æ°´åŒºé—´

### 1ï¸âƒ£ å·¦å³æœ€å¤§é«˜åº¦é¢„å¤„ç†

å¯¹æ¯ä¸ªä½ç½® `i`ï¼š

- `left[i]`ï¼š`i` å·¦ä¾§çš„æœ€å¤§é«˜åº¦
- `right[i]`ï¼š`i` å³ä¾§çš„æœ€å¤§é«˜åº¦

```
left[i] = max(height[0..i-1])
right[i] = max(height[i+1..n-1])
```

è¿™æ˜¯æ¥é›¨æ°´é—®é¢˜ä¸­çš„ç»å…¸é¢„å¤„ç†æ­¥éª¤ã€‚

------

### 2ï¸âƒ£ è®¡ç®—æ¯ä¸ªä½ç½®çš„â€œæœ€ç»ˆæ°´ä½çº¿â€

å¯¹ä½ç½® `i`ï¼Œå…¶åœ¨æœ€ç»ˆç¨³å®šçŠ¶æ€ä¸‹èƒ½è¾¾åˆ°çš„æœ€é«˜æ°´ä½ä¸ºï¼š

```
water_line[i] = min(left[i], right[i])
```

è‹¥ `water_line[i] > height[i]`ï¼Œè¯´æ˜è¯¥ä½ç½®å¯ä»¥è“„æ°´ã€‚

> âš ï¸ æ³¨æ„ï¼š
>  è¿™é‡Œçš„æ°´ä½çº¿æ˜¯ **å…¨å±€æ°´ä½çº¿**ï¼Œå¹¶ä¸æ˜¯ç”±æŸä¸€å¯¹å…·ä½“è¾¹ç•Œå•ç‹¬å†³å®šã€‚

------

### 3ï¸âƒ£ æšä¸¾å¯èƒ½çš„æ°´ä½ level

å°†æ‰€æœ‰å¯èƒ½çš„ `water_line[i]` æ”¶é›†èµ·æ¥ï¼Œä½œä¸ºå€™é€‰æ°´ä½ `level`ã€‚

å¯¹äºä¸€ä¸ªå›ºå®šçš„ `level`ï¼Œæˆ‘ä»¬å°è¯•å¯»æ‰¾ä¸€æ®µ **è¿ç»­åŒºé—´ `[l, r]`**ï¼Œæ»¡è¶³ï¼š

- `water_line[i] â‰¥ level`
- `height[i] < level`

è¿™æ®µåŒºé—´è¡¨ç¤ºï¼š
 åœ¨æ°´ä½ `level` ä¸‹ï¼Œèƒ½å¤Ÿå½¢æˆ**è¿ç»­çš„è“„æ°´åŒºåŸŸ**ã€‚

------

### 4ï¸âƒ£ è¾¹ç•Œä¸è“„æ°´åŒºåŸŸçš„å…³ç³»

- **çœŸæ­£è“„æ°´çš„åŒºåŸŸ**ï¼š`[l, r]`
- **æŒ¡æ¿ï¼ˆè¾¹ç•Œï¼‰ä½ç½®**ï¼š`l - 1` å’Œ `r + 1`

```
æŒ¡æ¿        è“„æ°´åŒºåŸŸ         æŒ¡æ¿
(l-1) |  l  ...  r  | (r+1)
```

------

### 5ï¸âƒ£ è®¡ç®—è“„æ°´é‡

åœ¨æ°´ä½ `level` ä¸‹ï¼Œè¯¥æ°´åº“çš„è“„æ°´é‡ä¸ºï¼š

```
Î£ max(0, level - height[i])ï¼Œi âˆˆ [l, r]
```

åœ¨æ‰€æœ‰æ°´ä½å’ŒåŒºé—´ç»„åˆä¸­ï¼Œé€‰æ‹©ï¼š

1. è“„æ°´é‡æœ€å¤§çš„æ–¹æ¡ˆ
2. è‹¥è“„æ°´é‡ç›¸åŒï¼Œé€‰æ‹©è¾¹ç•Œè·ç¦»æœ€è¿‘çš„æ–¹æ¡ˆ

## äº”ã€å®Œæ•´å¯ AC ä»£ç ï¼ˆPythonï¼‰

```python
1def main():
    """
    ä¸»å‡½æ•°: è®¡ç®—Xæ˜Ÿè“„æ°´åº“çš„æœ€ä¼˜è¾¹ç•Œå’Œæœ€å¤§è“„æ°´é‡
    """
    # è¯»å–è¾“å…¥
    heights = list(map(int, input().split()))
    n = len(heights)
    
    # è®¡ç®—å·¦ä¾§æœ€å¤§é«˜åº¦
    left = [0] * n
    for i in range(1, n):
        left[i] = max(left[i - 1], heights[i - 1])
    
    # è®¡ç®—å³ä¾§æœ€å¤§é«˜åº¦
    right = [0] * n
    for i in range(n - 2, -1, -1):
        right[i] = max(right[i + 1], heights[i + 1])
    
    # è®¡ç®—æ¯ä¸ªä½ç½®çš„æ°´ä½çº¿
    water_line = [0] * n
    water_levels = set()
    
    for i in range(1, n - 1):
        water = max(0, min(left[i], right[i]) - heights[i])
        if water > 0:
            water_line[i] = water + heights[i]
            water_levels.add(water_line[i])
    
    # åˆå§‹åŒ–ç»“æœ [å·¦è¾¹ç•Œ, å³è¾¹ç•Œ, æœ€å¤§è“„æ°´é‡]
    res = [0, 0, 0]
    
    # éå†æ¯ä¸ªå¯èƒ½çš„æ°´ä½çº¿
    for level in sorted(water_levels):
        # æ‰¾å·¦è¾¹ç•Œï¼šä»å·¦å‘å³æ‰¾ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„ä½ç½®
        l = 0
        while l < n and (water_line[l] < level or heights[l] >= level):
            l += 1
        
        # æ‰¾å³è¾¹ç•Œï¼šä»å³å‘å·¦æ‰¾ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„ä½ç½®
        r = n - 1
        while r >= 0 and (water_line[r] < level or heights[r] >= level):
            r -= 1
        
        # è®¡ç®—è¿™ä¸ªæ°´ä½çº¿ä¸‹çš„æ€»è“„æ°´é‡
        sum_water = sum(max(0, level - heights[i]) for i in range(l, r + 1))
        
        # æ›´æ–°æœ€ä¼˜ç»“æœï¼ˆè“„æ°´é‡æ›´å¤§ï¼Œæˆ–è“„æ°´é‡ç›¸åŒä½†è·ç¦»æ›´å°ï¼‰
        if sum_water > res[2] or (sum_water == res[2] and (r - l + 1) < (res[1] - res[0] + 1)):
            res = [l - 1, r + 1, sum_water]
    
    # è¾“å‡ºç»“æœ
    print("0" if res[2] == 0 else f"{res[0]} {res[1]}:{res[2]}")


# ç¨‹åºå…¥å£
if __name__ == "__main__":
    main()
```



## å…­ã€å…³äºåˆ¤é¢˜æ¨¡å‹çš„é‡è¦è¯´æ˜

ä»ä¸¥æ ¼çš„ç‰©ç†å»ºæ¨¡è§’åº¦ï¼š

- ä¸åŒè¾¹ç•Œå¯¹å½¢æˆçš„æ°´åº“åº”å½¼æ­¤ç‹¬ç«‹
- å•è°ƒæ ˆå¯ä»¥æšä¸¾æ‰€æœ‰åˆæ³•è¾¹ç•Œç»“æ„ï¼ˆO(n)ï¼‰

ä½†**æœ¬é¢˜åˆ¤é¢˜ç³»ç»Ÿé‡‡ç”¨çš„æ˜¯â€œå…¨å±€æ°´ä½çº¿æ¨¡å‹â€**ï¼š

> å…è®¸åœ¨åŒä¸€æ°´ä½ä¸‹ï¼Œå°†å¤šä¸ªç†è®ºä¸Šå¯è“„æ°´çš„ä½ç½®åˆå¹¶ä¸ºä¸€ä¸ªè¿ç»­æ°´åº“ã€‚

å› æ­¤ï¼Œ**åŸºäºæ°´ä½çº¿æšä¸¾çš„è§£æ³•æ‰èƒ½é€šè¿‡æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹**ã€‚



## ä¸ƒã€æ€»ç»“

- æœ¬é¢˜æ˜¯ **æ¥é›¨æ°´æ¨¡å‹çš„æ‰©å±•åº”ç”¨**

- å…³é”®ä¸åœ¨â€œæ€ä¹ˆé€‰è¾¹ç•Œâ€ï¼Œè€Œåœ¨äºï¼š

  > **ç†è§£åˆ¤é¢˜æ‰€é‡‡ç”¨çš„æ°´ä½çº¿å»ºæ¨¡æ–¹å¼**

- åªè¦ä»å…¨å±€æ°´ä½çº¿å‡ºå‘ï¼Œå¯»æ‰¾æœ€å¤§è¿ç»­è“„æ°´åŒºé—´ï¼Œå³å¯å¾—åˆ°æ­£ç¡®ç­”æ¡ˆ



## å…«ã€ç–‘æƒ‘

Q1:question:

> ```python
> leetcode 42é¢˜åŒæ•°ç»„æ€è·¯ä¸æ˜¯è¿™æ ·å— 
>   for i in range(1, n): 
>         pre_max[i] = max(pre_max[i-1], height[i])
>     suf_max = [0] * n
>     suf_max[-1] = height[-1]
>     for i in range(n-2, -1, -1):
>         suf_max[i] = max(suf_max[i+1], height[i])
> ä¸ºä»€ä¹ˆè¿™ä¸ªä»£ç ä¸åŠ ä¸Šheights[i]å‘¢ 
> # è®¡ç®—å·¦ä¾§æœ€å¤§é«˜åº¦
> left = [0] * n
> for i in range(1, n):
>     left[i] = max(left[i - 1], heights[i - 1])
> 
> # è®¡ç®—å³ä¾§æœ€å¤§é«˜åº¦
> right = [0] * n
> for i in range(n - 2, -1, -1):
>     right[i] = max(right[i + 1], heights[i + 1])
> ```



A1:

> **ä¸æ˜¯â€œå°‘ç®—äº†â€ï¼Œè€Œæ˜¯â€œç®—çš„æ ¹æœ¬ä¸æ˜¯åŒä¸€ä¸ªä¸œè¥¿â€**
>
> - **LeetCode 42** ä¸­çš„ `pre_max / suf_max`
>    ğŸ‘‰ è¡¨ç¤º **â€œåŒ…å«å½“å‰ä½ç½®çš„æœ€é«˜æŒ¡æ¿â€**
> - **ä½ è¿™é“é¢˜é‡Œçš„ `left / right`**
>    ğŸ‘‰ è¡¨ç¤º **â€œä¸åŒ…å«å½“å‰ä½ç½®ã€çº¯ç²¹åœ¨å·¦/å³ä¾§çš„æŒ¡æ¿â€**



LC42 è¦ç®—çš„æ˜¯ï¼š

```
water[i] = min(pre_max[i], suf_max[i]) - height[i]
```

å¦‚æœä¸åŒ…å« `height[i]`ï¼š

- ä¼šå‡ºç° `min(...) < height[i]`
- å¯¼è‡´è´Ÿå€¼æˆ–é€»è¾‘é”™è¯¯



### æœ¬é¢˜é‡Œçš„ `left / right`

```
left[i]  = max(height[0..i-1])
right[i] = max(height[i+1..n-1])
```

**åˆ»æ„æ’é™¤äº† `height[i]`**

ä¸ºä»€ä¹ˆï¼Ÿ

å› ä¸ºè¿™é‡Œçš„è¯­ä¹‰æ˜¯ï¼š

> **â€œi è¿™ä¸ªä½ç½®èƒ½è“„æ°´ï¼Œé çš„æ˜¯å·¦å³ä¸¤ä¾§çš„æŒ¡æ¿ï¼Œè€Œä¸æ˜¯å®ƒè‡ªå·±â€**



> å‰åç¼€ max è§£å†³çš„æ˜¯â€œç»™å®šæŒ¡æ¿ï¼Œç‚¹èƒ½è£…å¤šå°‘æ°´â€ï¼›
> æœ¬é¢˜è§£å†³çš„æ˜¯â€œç»™å®šæ°´ä½ï¼Œå“ªå¯¹æŒ¡æ¿æœ€å¥½â€ã€‚